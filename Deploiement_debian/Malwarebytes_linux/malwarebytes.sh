func_malwarebytes()
{
#!/bin/bash
#=======================================================================
# FILE: ~malwarebytes.sh
# USAGE: ./~malwarebytes.sh
# DESCRIPTION: Installation du package malwarebytes sur les postes debians
#
# OPTIONS: ---
# REQUIREMENTS: ---
# BUGS: ---
# NOTES: ---
# AUTHOR: Maxime Tertrais
# COMPANY: Operis
# CREATED: 30/09/2024
# REVISION: ---
#=======================================================================
##Définition des variables
srclist="/etc/apt/sources.list.d/mblinux.list"
folder=$(pwd) ##dossier local
log_erreurs="$folder/err_log.log"
#=======================================================================
##Définition des fonctions
func_dependances(){
	apt-get update
	apt install -y realmd sssd sssd-tools libnss-sss libpam-sss adcli samba-common-bin oddjob oddjob-mkhomedir packagekit policykit-1 ntpdate ntp krb5-user libsss-sudo libsasl2-modules-ldap libpam-mount samba samba-common
    }

#=======================================================================
##Script
echo "Mise a jour dependances pour l'installation de Malwarebytes"
	if func_dependances 2>> $log_erreurs; then
		echo "Mise a jour dependances nécessaire à l'installation de Malwarebytes réussie"
	else
		echo "Erreur lors de la mise a jour dependances nécessaire à l'installation de Malwarebytes"
		echo "logs d'erreurs disponibles dans le fichier: $log_erreurs"
        exit 1
	fi
    sleep 2

echo "création de la source du depôt"
	if touch $srclist >> /dev/null 2>> $log_erreurs; then
		echo "Création du fichier sourcelist de MalwareBytes réussi"
	else
		echo "Erreur lors de la création du fichier sourcelist de MalwareBytes"
		echo "logs d'erreurs disponibles dans le fichier: $log_erreurs"
	fi
    sleep 2

echo "Ajout de l'adresse du dépôt au fichier sourcelist"
	if echo 'deb [arch=amd64] https://repositories.mwbsys.com/dpkg jessie non-free' | tee -a $srclist >> /dev/null 2>> $log_erreurs; then
		echo "Saisie de l'adresse du dépôt réussi"
	else
		echo "Erreur lors de la Saisie de l'adresse du dépôt"
		echo "logs d'erreurs disponibles dans le fichier: $log_erreurs"
	fi
    sleep 2

echo "Téléchargement du paquet MalwareBytes"
	if wget -q -O - https://repositories.mwbsys.com/dpkg/keyring.gpg | apt-key add - >> /dev/null 2>> $log_erreurs; then
		echo "Téléchargement du paquet MalwareBytes réussi"
	else
		echo "Erreur lors du téléchargement du paquet MalwareBytes"
		echo "logs d'erreurs disponibles dans le fichier: $log_erreurs"
	fi
    sleep 2

echo "Installation du paquet MalwareBytes"
	if apt-get update; ACCOUNTTOKEN=cbfa3f5f-e8a5-4603-bb2f-f034e56fdf21 apt-get install mblinux >> /dev/null 2>> $log_erreurs; then
		echo "Installation du paquet MalwareBytes réussi"
	else
		echo "Erreur lors du installation du paquet MalwareBytes"
		echo "logs d'erreurs disponibles dans le fichier: $log_erreurs"
	fi
    sleep 2

}